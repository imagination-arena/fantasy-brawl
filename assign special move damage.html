<html><head><base href="assign-damage.html"><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Assign Special Move Damage</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

body {
  font-family: 'Press Start 2P', cursive;
  background-color: #2c3e50;
  color: #ecf0f1;
  display: flex;
  padding: 20px;
}

#main-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
}

#side-menu {
  width: 200px;
  background-color: #34495e;
  padding: 20px;
  margin-right: 20px;
  border-radius: 10px;
}

#side-menu ul {
  list-style-type: none;
  padding: 0;
}

#side-menu li {
  margin-bottom: 15px;
}

#side-menu a {
  color: #ecf0f1;
  text-decoration: none;
  transition: color 0.3s;
}

#side-menu a:hover {
  color: #e74c3c;
}

h1 {
  text-align: center;
  color: #e74c3c;
  text-shadow: 2px 2px #34495e;
  margin-bottom: 20px;
}

#damageCanvas {
  border: 4px solid #e74c3c;
  box-shadow: 0 0 10px rgba(231, 76, 60, 0.7);
  image-rendering: pixelated;
}

#stats {
  margin-top: 20px;
  background-color: #34495e;
  padding: 15px;
  border-radius: 10px;
  text-align: center;
}

button {
  font-family: 'Press Start 2P', cursive;
  background-color: #e74c3c;
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 20px 2px;
  cursor: pointer;
  transition: background-color 0.3s;
}

button:hover {
  background-color: #c0392b;
}

#instructions {
  max-width: 600px;
  text-align: center;
  margin-bottom: 20px;
  line-height: 1.6;
}
</style>
</head>
<body>
  <div id="side-menu">
    <ul>
      <li><a href="index.html">Main Menu</a></li>
      <li><a href="create-fighting-moves.html">Back to Create Moves</a></li>
      <li><a href="help.html">Help</a></li>
      <li><a href="settings.html">Settings</a></li>
    </ul>
  </div>

  <div id="main-content">
    <h1>Assign Special Move Damage</h1>
    
    <div id="instructions">
      Click on the pixels below to assign damage for your special move.
      The total damage of 1000 points will be divided equally among the selected pixels.
    </div>
    
    <canvas id="damageCanvas" width="640" height="320"></canvas>
    
    <div id="stats">
      <div id="damagePerPixel">Damage per pixel: 0</div>
      <div id="totalPixels">Total pixels selected: 0</div>
    </div>
    
    <button id="finishButton">Finish</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const canvas = document.getElementById('damageCanvas');
      const ctx = canvas.getContext('2d');
      const damagePerPixelElement = document.getElementById('damagePerPixel');
      const totalPixelsElement = document.getElementById('totalPixels');
      const finishButton = document.getElementById('finishButton');

      const totalDamage = 1000;
      let selectedPixels = new Set();

      function initializeCanvas() {
        ctx.fillStyle = '#2c3e50';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      }

      function updateStats() {
        const damagePerPixel = selectedPixels.size > 0 ? Math.floor(totalDamage / selectedPixels.size) : 0;
        damagePerPixelElement.textContent = `Damage per pixel: ${damagePerPixel}`;
        totalPixelsElement.textContent = `Total pixels selected: ${selectedPixels.size}`;
      }

      function togglePixel(x, y) {
        const key = `${x},${y}`;
        if (selectedPixels.has(key)) {
          selectedPixels.delete(key);
          ctx.fillStyle = 'rgba(255, 255, 0, 0.5)';
        } else {
          selectedPixels.add(key);
          ctx.fillStyle = 'rgba(255, 255, 0, 0.5)';
        }
        ctx.fillRect(x, y, 1, 1);
        updateStats();
      }

      canvas.addEventListener('click', (e) => {
        const rect = canvas.getBoundingClientRect();
        const x = Math.floor((e.clientX - rect.left) / (rect.width / 640));
        const y = Math.floor((e.clientY - rect.top) / (rect.height / 320));
        togglePixel(x, y);
      });

      finishButton.addEventListener('click', () => {
        const damageMap = Array.from(selectedPixels).reduce((acc, key) => {
          acc[key] = Math.floor(totalDamage / selectedPixels.size);
          return acc;
        }, {});

        localStorage.setItem('specialMoveDamage', JSON.stringify(damageMap));
        window.location.href = 'battle-arena.html';
      });

      initializeCanvas();
      updateStats();
    });
  </script>
</body>
</html>

<script>
  // Redirect to battle-arena.html
  window.location.href = 'battle-arena.html';
</script>
